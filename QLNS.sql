CREATE DATABASE QLNS
USE QLNS

CREATE TABLE QUANTRI
(
	EMAIL varchar(50) PRIMARY KEY,
	Admin bit,
	HOTEN nvarchar(50),
	Password nvarchar(50)
)
CREATE TABLE BOMON
(
	MABM VARCHAR(10) PRIMARY KEY ,
	TENBM NVARCHAR(50) NOT NULL,
	MAKHOA VARCHAR(10) NOT NULL,
)
CREATE TABLE KHOA 
(
	MAKHOA VARCHAR(10) PRIMARY KEY ,
	TENKHOA NVARCHAR(100) NOT NULL,
)

CREATE TABLE GIAOVIEN
(
	MAGV VARCHAR(10) PRIMARY KEY ,
	HOGV NVARCHAR(50) NOT NULL ,
	TENGV NVARCHAR(50) NOT NULL ,
	NGAYSINH DATE NOT NULL ,
	DIACHI NVARCHAR(100) NOT NULL ,
	GIOITINH bit DEFAULT(1),
	CMND VARCHAR(12) NOT NULL,
	DANTOC NVARCHAR(20),
	DIENTHOAI VARCHAR (10) NOT NULL,
	EMAIL VARCHAR (100) NOT NULL,
	MABM VARCHAR(10)  NOT NULL,
	ANH VARCHAR(100),
	GHICHU NVARCHAR (100),
)
CREATE TABLE BANGTRINHDODH
(
	MATRINHDODH VARCHAR(10) PRIMARY KEY ,
	TRINHDO NVARCHAR(100) NOT NULL,
)
CREATE TABLE BANGTRINHDOSAUDH
(
	MATRINHDOSAUDH VARCHAR(10) PRIMARY KEY ,
	TRINHDO NVARCHAR(100) NOT NULL,
)
CREATE TABLE TRINHDOHOCVAN
(
	MATRINHDO VARCHAR(10) PRIMARY KEY ,
	MAGV VARCHAR(10) NOT NULL,
	HOCVI NVARCHAR(10) NOT NULL,
	MATRINHDODH VARCHAR(10) NOT NULL,
	MATRINHDOSAUDH VARCHAR(10),
	CHUYENMON NVARCHAR(100) NOT NULL,
)
CREATE TABLE THANNHAN
(
	MAGV VARCHAR(10)  ,
	HOTENTN NVARCHAR(100) ,
	NGAYSINH DATE,
	DIENTHOAI VARCHAR(10) NOT NULL,
	QUANHE NVARCHAR(100) NOT NULL,
	CONSTRAINT PK_THANNHAN PRIMARY KEY (MAGV,HOTENTN),
)
CREATE TABLE LUONGCS
(
	MALUONGCS VARCHAR(5) PRIMARY KEY ,
	LUONGCOSO MONEY NOT NULL,
)
CREATE TABLE LUONG
(
	MALUONG VARCHAR(10) PRIMARY KEY ,
	MAGV VARCHAR(10) NOT NULL ,
	MALUONGCS VARCHAR(5) NOT NULL,
	HESOLUONG FLOAT NOT NULL ,
	NNTHEM SMALLINT,
	GHICHU NVARCHAR (50),
)
CREATE TABLE HDLAODONG
(
	MAHD VARCHAR(10) ,
	MAGV VARCHAR(10) ,
	NGAYBD DATE NOT NULL,
	NGAYKT DATE ,
	GHICHU NVARCHAR (50),
	CONSTRAINT PK_HDLAODONG PRIMARY KEY (MAHD,MAGV)
)

ALTER TABLE BOMON ADD CONSTRAINT FK_BOMON_KHOA FOREIGN KEY (MAKHOA) REFERENCES KHOA (MAKHOA)
ALTER TABLE GIAOVIEN ADD CONSTRAINT FK_GIAOVIEN_BOMON FOREIGN KEY (MABM) REFERENCES BOMON (MABM)
ALTER TABLE LUONG ADD CONSTRAINT FK_LUONG_LUONGCS FOREIGN KEY (MALUONGCS) REFERENCES LUONGCS (MALUONGCS)
ALTER TABLE TRINHDOHOCVAN ADD CONSTRAINT FK_TRINHDOHOCVAN_BANGTRINHDODH FOREIGN KEY (MATRINHDODH) REFERENCES BANGTRINHDODH (MATRINHDODH)
ALTER TABLE TRINHDOHOCVAN ADD CONSTRAINT FK_TRINHDOHOCVAN_BANGTRINHDOSAUDH FOREIGN KEY (MATRINHDOSAUDH) REFERENCES BANGTRINHDOSAUDH (MATRINHDOSAUDH)
ALTER TABLE TRINHDOHOCVAN  ADD CONSTRAINT FK_TRINHDOHOCVAN_GIAOVIEN FOREIGN KEY (MAGV) REFERENCES GIAOVIEN (MAGV)

ALTER TABLE THANNHAN 
ADD CONSTRAINT FK_THANNHAN_GIAOVIEN
 FOREIGN KEY (MAGV) 
 REFERENCES GIAOVIEN (MAGV)
 ON DELETE CASCADE
 ON UPDATE CASCADE;

ALTER TABLE LUONG 
ADD CONSTRAINT FK_LUONG_GIAOVIEN
 FOREIGN KEY (MAGV) 
 REFERENCES GIAOVIEN (MAGV)
 ON DELETE CASCADE
 ON UPDATE CASCADE;

ALTER TABLE HDLAODONG 
ADD CONSTRAINT FK_HDLAODONG_GIAOVIEN
 FOREIGN KEY (MAGV) 
 REFERENCES GIAOVIEN (MAGV)
 ON DELETE CASCADE
 ON UPDATE CASCADE;
 SELECT Admin FROM QUANTRI WHERE HOTEN=N'Phan Thị Huyền Trâm'
/*ALTER TABLE GIAOVIEN DROP CONSTRAINT FK_GIAOVIEN_KHOA*/
--insert table QUANTRI
INSERT INTO QUANTRI VALUES('chauquocnguyen.cun1@gmail.com',1,N'Nguyễn Quốc Châu','chauit')
INSERT INTO QUANTRI VALUES('tram.pth.61cntt@ntu.edu.vn',1,N'Phan Thị Huyền Trâm','tram')

--insert table BANGTRINHDODH
INSERT BANGTRINHDODH VALUES ('TDDH01',N'Sư phạm Toán Học')
INSERT BANGTRINHDODH VALUES ('TDDH02',N'Sư phạm Tin Học')
INSERT BANGTRINHDODH VALUES ('TDDH03',N'Sư phạm Vật Lý')
INSERT BANGTRINHDODH VALUES ('TDDH04',N'Sư phạm Ngữ Văn')
INSERT BANGTRINHDODH VALUES ('TDDH05',N'Sư phạm Lịch Sử')
INSERT BANGTRINHDODH VALUES ('TDDH06',N'Sư phạm Địa Lý')
INSERT BANGTRINHDODH VALUES ('TDDH08',N'Sư phạm Tiếng Anh')
INSERT BANGTRINHDODH VALUES ('TDDH09',N'Sư phạm Giáo dục thể chất')
INSERT BANGTRINHDODH VALUES ('TDDH10',N'Sư phạm Sinh Học')
INSERT BANGTRINHDODH VALUES ('TDDH11',N'Sư phạm Giáo dục công dân')
INSERT BANGTRINHDODH VALUES ('TDDH12',N'Sư phạm Hóa Học')


--insert table BANGTRINHDOSAUDH
INSERT BANGTRINHDOSAUDH VALUES ('TDSDH01',N'Công nghệ thông tin')
INSERT BANGTRINHDOSAUDH VALUES ('TDSDH02',N'Sư phạm Tiếng Nga')
INSERT BANGTRINHDOSAUDH VALUES ('TDSDH03',N'Kỹ Thuật Môi Trường')
INSERT BANGTRINHDOSAUDH VALUES ('TDSDH04',N'Luật')
--insert table KHOA
INSERT KHOA VALUES ('TN',N'Khoa tự nhiên')
INSERT KHOA VALUES ('XH',N'Khoa xã hội')
INSERT KHOA VALUES ('GDTC',N'Khoa giáo dục thể chất')
INSERT KHOA VALUES ('NN',N'Khoa ngoại ngữ')
--insert table BOMON
INSERT BOMON VALUES ('TH',N'Tin học','TN')
INSERT BOMON VALUES ('VL',N'Vật lý','TN')
INSERT BOMON VALUES ('T',N'Toán','TN')
INSERT BOMON VALUES ('NV',N'Ngữ văn','XH')
INSERT BOMON VALUES ('SH',N'Sinh học','TN')
INSERT BOMON VALUES ('HH',N'Hóa học','TN')
INSERT BOMON VALUES ('TD',N'Thể dục','GDTC')
INSERT BOMON VALUES ('LS',N'Lịch sử','XH')
INSERT BOMON VALUES ('DL',N'Địa lý','XH')
INSERT BOMON VALUES ('GDCD',N'Giáo dục công dân','XH')
INSERT BOMON VALUES ('TA',N'Ngoại ngữ','NN')
INSERT BOMON VALUES ('GDQP',N'Giáo dục Quốc phòng và An ninh','GDTC')
--insert table GIAOVIEN
INSERT GIAOVIEN VALUES ('GV01',N'Nguyễn Quốc',N'Châu',CAST(N'2001-11-23' AS Date),N'Nha Trang, Khánh Hòa',1,'225941000',NULL,'0926383006',
'chauquocnguyen.cun1@gmail.com','TH',NULL,NULL)
INSERT GIAOVIEN VALUES ('GV02',N'Lê Thị Thu',N'Thảo',CAST(N'1997-07-12' AS Date),N'Ninh Hòa, Khánh Hòa',0,'223561000','Kinh','0383698287',
'lethithuthao@gmail.com','T',NULL,NULL)
INSERT GIAOVIEN VALUES ('GV03',N'Lê Thi Ánh',N'Cúc',CAST(N'1997-02-17' AS Date),N'Hoài Nhơn, Bình Định',0,'223557890','Kinh','0375968287',
'anhcuc@gmail.com','NV',NULL,NULL)
INSERT GIAOVIEN VALUES ('GV04',N'Cao Văn',N'Vương',CAST(N'1997-08-05' AS Date),N'Ninh Hòa, Khánh Hòa',1,'225569700','Kinh','0589738287',
'vanvuong@gmail.com','SH',NULL,NULL)
INSERT GIAOVIEN VALUES ('GV05',N'Nguyễn Thị',N'Cúc',CAST(N'1999-02-12' AS Date),N'Ninh Hòa, Khánh Hòa',0,'228865900',N'H Mông','0965698287',
'nguyenthicuc@gmail.com','HH',NULL,NULL)
INSERT GIAOVIEN VALUES ('GV06',N'Trần Thị',N'Ba',CAST(N'1990-02-20' AS Date),N'Ninh Hòa, Khánh Hòa',0,'289655900',N'Mường','0965456787',
'tranthiba@gmail.com','TD',NULL,NULL)
INSERT GIAOVIEN VALUES ('GV07',N'Lê Minh',N'Hoàng',CAST(N'1989-05-21' AS Date),N'Ninh Hòa, Khánh Hòa',1,'257892900',NULL,'0966547887',
'minhhoang@gmail.com','LS',NULL,NULL)
INSERT GIAOVIEN VALUES ('GV08',N'Lê Đinh',N'Huy',CAST(N'1999-11-21' AS Date),N'Ninh Hòa, Khánh Hòa',1,'278451900',NULL,'0659832887',
'dinhhuy@gmail.com','DL',NULL,NULL)
INSERT GIAOVIEN VALUES ('GV09',N'Lê',N'Lợi',CAST(N'1999-11-21' AS Date),N'Ninh Hòa, Khánh Hòa',1,'275693200','Kinh','0636954887',
'leloi@gmail.com','GDCD',NULL,N'nhiều tiền')
INSERT GIAOVIEN VALUES ('GV10',N'Lê Thị Mỹ',N'Hạnh',CAST(N'1997-11-21' AS Date),N'Ninh Hòa, Khánh Hòa',0,'278456980','Kinh','0659732887',
'myhanh@gmail.com','TA',NULL,NULL)
INSERT GIAOVIEN VALUES ('GV11',N'Lê Linh',N'Đành',CAST(N'1989-11-1' AS Date),N'Ninh Hòa, Khánh Hòa',1,'274587900',NULL,'0656935887',
'linhdanh@gmail.com','GDQP',NULL,NULL)
INSERT GIAOVIEN VALUES ('GV12',N'Lê',N'Huy',CAST(N'1989-7-02' AS Date),N'Ninh Hòa, Khánh Hòa',1,'278456980',NULL,'0636952887',
'lehuy@gmail.com','T',NULL,NULL)
--insert table LUONGCS
INSERT LUONGCS VALUES('LCS1',1490000)
--insert table LUONG
INSERT LUONG VALUES('ML001','GV01','LCS1',4.4,NULL,'10')
INSERT LUONG VALUES('ML002','GV02','LCS1',4.74,NULL,'10')
INSERT LUONG VALUES('ML003','GV01','LCS1',6.78,NULL,'10')
INSERT LUONG VALUES('ML004','GV01','LCS1',6.78,NULL,'10')
INSERT LUONG VALUES('ML005','GV01','LCS1',4.74,NULL,'10')
INSERT LUONG VALUES('ML006','GV01','LCS1',4.4,NULL,'10')
INSERT LUONG VALUES('ML007','GV01','LCS1',4.74,NULL,'10')
INSERT LUONG VALUES('ML008','GV01','LCS1',6.78,NULL,'10')
INSERT LUONG VALUES('ML009','GV01','LCS1',4.4,NULL,'10')
INSERT LUONG VALUES('ML010','GV01','LCS1',4.74,NULL,'10')
INSERT LUONG VALUES('ML011','GV01','LCS1',4.4,NULL,'10')
INSERT LUONG VALUES('ML012','GV01','LCS1',4.74,NULL,'10')
--insert table HDLAODONG
INSERT HDLAODONG VALUES ('HD01','GV01',CAST(N'2011-1-1' AS Date),CAST(N'2021-1-1' AS Date),NULL)
INSERT HDLAODONG VALUES ('HD06','GV06',CAST(N'2012-1-1' AS Date),CAST(N'2022-1-1' AS Date),NULL)
INSERT HDLAODONG VALUES ('HD02','GV02',CAST(N'2013-1-1' AS Date),NULL,NULL)
INSERT HDLAODONG VALUES ('HD07','GV07',CAST(N'2014-1-1' AS Date),CAST(N'2020-9-9' AS Date),NULL)
INSERT HDLAODONG VALUES ('HD05','GV05',CAST(N'2011-5-1' AS Date),CAST(N'2015-10-10' AS Date),NULL)
INSERT HDLAODONG VALUES ('HD04','GV04',CAST(N'2011-8-1' AS Date),CAST(N'2015-8-1' AS Date),NULL)
INSERT HDLAODONG VALUES ('HD03','GV03',CAST(N'2011-8-1' AS Date),CAST(N'2012-6-1' AS Date),NULL)
INSERT HDLAODONG VALUES ('HD08','GV08',CAST(N'2021-8-1' AS Date),NULL,NULL)
INSERT HDLAODONG VALUES ('HD09','GV09',CAST(N'2020-12-12' AS Date),CAST(N'2025-12-1' AS Date),NULL)
INSERT HDLAODONG VALUES ('HD11','GV11',CAST(N'2016-9-9' AS Date),CAST(N'2022-9-9' AS Date),NULL)
INSERT HDLAODONG VALUES ('HD10','GV10',CAST(N'2011-10-10' AS Date),CAST(N'2021-10-10' AS Date),NULL)
INSERT HDLAODONG VALUES ('HD12','GV12',CAST(N'2021-1-1' AS Date),CAST(N'2025-1-1' AS Date),NULL)

--insert table THANNHAN
INSERT THANNHAN VALUES ('GV01',N'Nguyễn Thị Hoa',NULL ,'0234900129',N'Mẹ')
INSERT THANNHAN VALUES ('GV02',N'Trần Đức Trọng','1978-12-2','0123802830',N'Bố')
INSERT THANNHAN VALUES ('GV03',N'Nguyễn Minh Đức','1990-12-12','0239482030',N'Chồng')
INSERT THANNHAN VALUES ('GV11',N'Lê Thị Thúy',NULL ,'0239482123',N'Chị')
INSERT THANNHAN VALUES ('GV05',N'Nguyễn Văn Phong','2003-2-2','0239482122',N'Em trai')
INSERT THANNHAN VALUES ('GV10',N'Mai Toàn Thắng',NULL ,'0239482111',N'Chồng')
--insert table TRINHDOHOCVAN 
INSERT TRINHDOHOCVAN VALUES ('TD01','GV01',N'Thạc sĩ','TDDH01',NULL,'Toán học')
INSERT TRINHDOHOCVAN VALUES ('TD02','GV02',N'Tiến sĩ','TDDH02','TDSDH04',N'Tin học')
INSERT TRINHDOHOCVAN VALUES ('TD03','GV03',N'Thạc sĩ','TDDH03',NULL,N'Vật Lý')
INSERT TRINHDOHOCVAN VALUES ('TD04','GV04',N'Giáo sư','TDDH04',NULL,N'Ngữ Văn')
INSERT TRINHDOHOCVAN VALUES ('TD05','GV05',N'Thạc sĩ','TDDH05',NULL,N'Lịch Sử')
INSERT TRINHDOHOCVAN VALUES ('TD06','GV06',N'Thạc sĩ','TDDH06',NULL,N'Địa Lý')
INSERT TRINHDOHOCVAN VALUES ('TD07','GV07',N'Thạc sĩ','TDDH07','TDSDH03',N'Hóa Học')
INSERT TRINHDOHOCVAN VALUES ('TD08','GV08',N'Giáo sư','TDDH08',NULL,N'Ngoại Ngữ')
INSERT TRINHDOHOCVAN VALUES ('TD09','GV09',N'Thạc sĩ','TDDH09',NULL,N'Giáo Dục Công Dân')
INSERT TRINHDOHOCVAN VALUES ('TD010','GV10',N'Tiến sĩ','TDDH10',NULL,N'Giáo Dục Thể Chất')
INSERT TRINHDOHOCVAN VALUES ('TD011','GV11',N'Thạc sĩ','TDDH10','TDSDH03',N'An Ninh - Quốc Phòng')
INSERT TRINHDOHOCVAN VALUES ('TD012','GV12',N'Tiến sĩ','TDDH11',NULL,N'Sinh học')




SELECT (L.HESOLUONG*LCS.LUONGCOSO) AS N'Tổng lương'
FROM LUONG L INNER JOIN LUONGCS LCS ON L.MALUONGCS = LCS.MALUONGCS





